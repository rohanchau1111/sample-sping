

implementation 'ch.appuio.techlab:artifactorytest:0.1.1-SNAPSHOT'





plugins {
    id 'java'
}

repositories {
    maven {
        url "http://172.27.225.231:8082/artifactory/libs-release-local" // Artifactory repository URL
        credentials {
            username = "${artifactory_user}"
            password = "${artifactory_password}"
        }
    }
}

dependencies {
    implementation 'com.example:my-war-artifact:1.0.0@war' // Coordinates of the WAR file
}

task extractWar(type: Copy) {
    doFirst {
        // Resolve the dependency at execution time, not configuration time
        def warFile = configurations.implementation.singleFile
        from zipTree(warFile)
    }
    into "$buildDir/extractedWar"
}

tasks.compileJava {
    dependsOn extractWar
}

task copyLibs(type: Copy) {
    from configurations.implementation // Copy the dependencies
    into "$buildDir/libs"
}

tasks.build {
    dependsOn copyLibs, extractWar
}

tasks.jar {
    archiveFileName = 'my-application.jar' // Name of your final JAR file
    from("$buildDir/extractedWar") {
        into 'webapp'
    }
}

